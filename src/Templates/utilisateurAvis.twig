{% extends "base.html.twig" %}

{% block head_title %}Arcadia-Gestion des avis
{% endblock %}

{% block head_description %}Gestion des avis
{% endblock %}

{% block stylesheet %}
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<link rel="stylesheet" href="{{base_url}}public/scss/main.css">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
{% endblock %}

{% block body %}

	<a href="{{base_url}}">Accueil</a>
	<a href="/admin">Admin</a>
	<br><br>

	{% if addResult is defined and addResult is not empty %}

		{# Page 'résultat' suite à une action créer, update ou delete terminée -------------------------------------#}

		{# résultat de l'action #}
		{{addResult}}
		<br>

		{# Liste des éléments liés pouvant empêcher la suppression #}
			{% if data is defined and data is not empty %}<h2>Liaisons relatives à l'élément à supprimer
		</h2>
		{% endif %}
			<a href="{{ base_url }}{{previousUrl}}"> Retour</a>
{% else %}

	<div class='container-fluid'>
		<div class='row justify-content-center'>
			<h1 class="col-11 col-md-9 col-lg-8 col-xl-6 col-xxl-5 m-5 text-center">Bienvenue dans votre espace de gestion des avis</h1>
		</div>
	</div>

	<br>
	<div class='container-fluid'>
		<div class='row justify-content-center'>
			<h2 class="col-11 col-md-9 col-lg-8 col-xl-6 col-xxl-5 m-5 text-center">Que voulez vous faire ?</h2>
		</div>
	</div>


	{# Page 'main' de la section avec CRUD ----------------------------------------------------------------------#}

	<div class='container-fluid'>
		<div class='row justify-content-start'>
			<h2 class="col-12 m-2">liste des
				{{pageName}}</h2>
		</div>

		{# Formulaire de recherche #}
		<form action="{{base_url}}{{previousUrl}}" method="get" enctype='multipart/form-data'>
			<input type="text" name='search'>
			<input type="hidden" name="tok" value={{ token }}>
			<button type="submit">Recherche
				{{pageName}}</button>
			<button onclick="location.href='{{ base_url }}{{previousUrl}}'">Reset</button>
		</form>

		{% if elements == 'une erreur est survenue' %}
			<b>une erreur est survenue</b>
		{% else %}

			{# Tableau des éléments #}
			<table>
				<thead>
					<tr>
						<th>Nom
							{{pageName}}</th>
						<th>Modifier</th>
						<th>Supprimer</th>
					</tr>
				</thead>

				<tbody>
					{% for element in elements %}
						<tr>
							<td>{{ element.valeur }}</td>

							<td>
								<form method="get" action="{{base_url}}{{updateUrl}}" enctype='multipart/form-data'>
									<input type="hidden" name="UpdateElementId" value={{ element.id }}>
									<input type="hidden" name="tok" value={{ token }}>
									<button type="submit">Modifier</button>
								</form>
							</td>

							<td>
								<form method="post" action="{{base_url}}{{deleteUrl}}" enctype='multipart/form-data'>
									<input type="hidden" name="deleteElementId" value={{ element.id }}>
									<input type="hidden" name="tok" value={{ token }}>
									<button type="submit">Supprimer</button>
								</form>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>

			{# Pagination #}
			<div class="pagination">
				page
				<br>
				{% if activePage > 1 %}
					<a href="?page={{ activePage - 1 }}&search={{search}}&tok={{token}}">Page précédente</a>
				{% endif %}

				{% for page in 1..pageMax %}
					{% if page == activePage %}
						<span class="current-page">{{ page }}</span>
					{% else %}
						<a href="?page={{ page }}&search={{search}}&tok={{token}}">{{ page }}</a>
					{% endif %}
				{% endfor %}

				{% if activePage < pageMax %}
					<a href="?page={{ activePage + 1 }}&search={{search}}&tok={{token}}">Page suivante</a>
				{% endif %}
			</div><br>
		</div>

	{% endif %}

	{# Retour vers page d'accueil admin #}
	<a href="{{base_url}}admin">Retour</a>
{% endif %}{% endblock %}
